# 教师教学成绩排名赋分计算规则说明文档

## 1. 概述

本系统用于计算各科目教师在不同考试中的教学成绩排名和赋分，最终生成综合排名。系统支持多个科目的批量计算，每个科目包含多个考试指标。

## 2. 输入表格结构

### 2.1 文件格式
- **文件类型**: Excel (.xls/.xlsx)
- **文件位置**: `data/2025Mid3.xls`
- **工作表**: 按科目分类（语文、数学、英语、物理、化学、道法、历史、地理、生物）

### 2.2 数据列结构
每个科目包含以下列：

| 列名 | 说明 | 示例 |
|------|------|------|
| 学校代码 | 学校唯一标识 | 78319 |
| 学校名称 | 学校名称 | 金山中学 |
| 班别 | 班级编号 | 10 |
| 科任教师 | 任课教师姓名 | 黄淑文 |

### 2.3 考试指标列
每个考试包含5个指标，共4个考试：

#### 第一次考试（中考）
- `中考语文平均分p1` - 平均分
- `中考语文优秀率y1` - 优秀率
- `中考语文优良率l1` - 优良率  
- `中考语文合格率h1` - 合格率
- `中考语文低分率d1` - 低分率

#### 第二次考试（二模）
- `二模语文平均分p2` - 平均分
- `二模语文优秀率y2` - 优秀率
- `二模语文优良率l2` - 优良率
- `二模语文合格率h2` - 合格率
- `二模语文低分率d2` - 低分率

#### 第三次考试（九年上）
- `九年上语文平均分p3` - 平均分
- `九年上语文优秀率y3` - 优秀率
- `九年上语文优良率l3` - 优良率
- `九年上语文合格率h3` - 合格率
- `九年上语文低分率d3` - 低分率

#### 第四次考试（八年下）
- `八年下语文平均分p4` - 平均分
- `八年下语文优秀率y4` - 优秀率
- `八年下语文优良率l4` - 优良率
- `八年下语文合格率h4` - 合格率
- `八年下语文低分率d4` - 低分率

## 3. 计算规则

### 3.1 赋分规则

#### 3.1.1 赋分区间（根据总人数调整）
**总人数 ≤ 20人时：**
- 第1-3名：8分（金山中学8.9分）
- 第4-7名：6分（金山中学6.9分）
- 第8-12名：5分（金山中学5.9分）
- 第13-18名：4分（金山中学4.9分）
- 第19-25名：3分（金山中学3.9分）
- 第26-30名：2分（金山中学2.9分）
- 第31名及以后：0分

**总人数 > 20人时（原始176人规则）：**
- 第1-18名：8分（金山中学8.9分）
- 第19-43名：6分（金山中学6.9分）
- 第44-71名：5分（金山中学5.9分）
- 第72-106名：4分（金山中学4.9分）
- 第107-134名：3分（金山中学3.9分）
- 第135-159名：2分（金山中学2.9分）
- 第160名及以后：0分

#### 3.1.2 学校类型判断
- **金山中学**: 使用金山赋分（8.9, 6.9, 5.9, 4.9, 3.9, 2.9, 0）
- **其他学校**: 使用常规赋分（8, 6, 5, 4, 3, 2, 0）

### 3.2 排名规则

#### 3.2.1 第一次考试（中考）
直接对5个指标进行排名：
- **平均分、优秀率、优良率、合格率**: 从高到低排序（越高越好）
- **低分率**: 从低到高排序（越低越好）

#### 3.2.2 第二、三、四次考试
计算相邻两次考试的差值，然后对差值进行排名：
- **差值计算**: 前一次考试 - 后一次考试
- **平均分、优秀率、优良率、合格率差值**: 正值表示进步，从高到低排序
- **低分率差值**: 负值表示进步，从低到高排序

### 3.3 加权计算规则

#### 3.3.1 单次考试加权总分
```
总分 = 平均分得分 × 0.3 + 优秀率得分 × 0.2 + 优良率得分 × 0.2 + 合格率得分 × 0.2 + 低分率得分 × 0.1
```

#### 3.3.2 综合得分加权
根据实际考试次数确定：
- **四次考试**: F = F1 × 0.4 + F2 × 0.2 + F3 × 0.2 + F4 × 0.2
- **三次考试**: F = F1 × 0.4 + F2 × 0.3 + F3 × 0.3
- **二次考试**: F = F1 × 0.4 + F2 × 0.6
- **一次考试**: F = F1

其中：
- F1: 第一次考试总分
- F2: 第二次考试总分
- F3: 第三次考试总分
- F4: 第四次考试总分

## 4. 输出表格结构

### 4.1 输出列顺序
每个指标后面依次插入：`指标名_排名`、`指标名_得分`列

### 4.2 完整输出结构示例
```
学校代码 | 学校名称 | 班别 | 语文科任 |
中考语文平均分p1 | 中考语文平均分p1_排名 | 中考语文平均分p1_得分 |
中考语文优秀率y1 | 中考语文优秀率y1_排名 | 中考语文优秀率y1_得分 |
中考语文优良率l1 | 中考语文优良率l1_排名 | 中考语文优良率l1_得分 |
中考语文合格率h1 | 中考语文合格率h1_排名 | 中考语文合格率h1_得分 |
中考语文低分率d1 | 中考语文低分率d1_排名 | 中考语文低分率d1_得分 |
中考语文总分 |
二模语文平均分p2 | 中考-二模平均分差值 | 中考-二模平均分差值_排名 | 中考-二模平均分差值_得分 |
二模语文优秀率y2 | 中考-二模优秀率差值 | 中考-二模优秀率差值_排名 | 中考-二模优秀率差值_得分 |
二模语文优良率l2 | 中考-二模优良率差值 | 中考-二模优良率差值_排名 | 中考-二模优良率差值_得分 |
二模语文合格率h2 | 中考-二模合格率差值 | 中考-二模合格率差值_排名 | 中考-二模合格率差值_得分 |
二模语文低分率d2 | 中考-二模低分率差值 | 中考-二模低分率差值_排名 | 中考-二模低分率差值_得分 |
二模语文总分 |
九年上语文平均分p3 | 二模-九年上平均分差值 | 二模-九年上平均分差值_排名 | 二模-九年上平均分差值_得分 |
九年上语文优秀率y3 | 二模-九年上优秀率差值 | 二模-九年上优秀率差值_排名 | 二模-九年上优秀率差值_得分 |
九年上语文优良率l3 | 二模-九年上优良率差值 | 二模-九年上优良率差值_排名 | 二模-九年上优良率差值_得分 |
九年上语文合格率h3 | 二模-九年上合格率差值 | 二模-九年上合格率差值_排名 | 二模-九年上合格率差值_得分 |
九年上语文低分率d3 | 二模-九年上低分率差值 | 二模-九年上低分率差值_排名 | 二模-九年上低分率差值_得分 |
九年上语文总分 |
八年下语文平均分p4 | 九年上-八年下平均分差值 | 九年上-八年下平均分差值_排名 | 九年上-八年下平均分差值_得分 |
八年下语文优秀率y4 | 九年上-八年下优秀率差值 | 九年上-八年下优秀率差值_排名 | 九年上-八年下优秀率差值_得分 |
八年下语文优良率l4 | 九年上-八年下优良率差值 | 九年上-八年下优良率差值_排名 | 九年上-八年下优良率差值_得分 |
八年下语文合格率h4 | 九年上-八年下合格率差值 | 九年上-八年下合格率差值_排名 | 九年上-八年下合格率差值_得分 |
八年下语文低分率d4 | 九年上-八年下低分率差值 | 九年上-八年下低分率差值_排名 | 九年上-八年下低分率差值_得分 |
八年下语文总分 |
综合得分 |
综合排名 |
```

## 5. 计算流程

### 5.1 主流程
1. 读取Excel文件
2. 识别科目标签（排除sheet1等非科目）
3. 对每个科目执行计算
4. 保存结果到新的Excel文件

### 5.2 单科目计算流程
1. **第一次考试计算**
   - 对5个指标分别排序
   - 根据排名赋分
   - 计算加权总分

2. **第二、三、四次考试计算**
   - 计算相邻考试差值
   - 对差值排序
   - 根据排名赋分
   - 计算加权总分

3. **综合计算**
   - 根据考试次数计算综合得分
   - 根据综合得分计算最终排名

## 6. 注意事项

### 6.1 数据处理
- 自动处理缺失值
- 列名标准化（去除空格等）
- 数据类型验证

### 6.2 错误处理
- 列名不匹配警告
- 数据缺失警告
- 计算异常处理

### 6.3 输出文件
- 文件名格式：`科目名排名赋分结果.xlsx`
- 保存位置：程序运行目录
- 包含所有计算过程和结果

## 7. 使用说明

1. 确保Excel文件位于`data/`目录下
2. 运行计算程序
3. 查看控制台输出的计算进度
4. 在输出目录找到结果文件
5. 验证计算结果的正确性

---

*本文档描述了完整的教师教学成绩排名赋分计算规则，如有疑问请参考代码实现或联系开发人员。*
